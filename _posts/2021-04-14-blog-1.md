---
layout: post
title: Blog Post 1
---

This post is a tutorial explaining how to visualize the correlation between Culmen Length and Flipper Length according to the Islands category in the Palmer Penguins dataset.

## ยง1. Create a Database


```python
import pandas as pd
import sqlite3
```


```python
conn = sqlite3.connect("temps.db")
```


```python
def prepare_df(df):
    df = df.set_index(keys=["ID", "Year"])
    df = df.stack()
    df = df.reset_index()
    df = df.rename(columns = {"level_2"  : "Month" , 0 : "Temp"})
    df["Month"] = df["Month"].str[5:].astype(int)
    df["Temp"]  = df["Temp"] / 100
    return(df)
```


```python
df_iter = pd.read_csv("temps.csv", chunksize = 100000)
for df in df_iter:
    df = prepare_df(df)
    df.to_sql("temperatures", conn, if_exists = "append", index = False)
```


```python
url = "https://raw.githubusercontent.com/PhilChodrow/PIC16B/master/datasets/noaa-ghcn/station-metadata.csv"
stations = pd.read_csv(url)
stations["FIPS"] = stations["ID"].str[0:2]
stations.to_sql("stations", conn, if_exists = "replace", index = False)
```


```python
url = "https://raw.githubusercontent.com/mysociety/gaze/master/data/fips-10-4-to-iso-country-codes.csv"
countries = pd.read_csv(url)
countries = countries.rename(columns={'FIPS 10-4':'FIPS', 'Name': 'Country'})
countries.to_sql("countries", conn, if_exists = "replace", index = False)
```